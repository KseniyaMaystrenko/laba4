# условие к лабораторной 4:
# Решите обе задачи своего варианта.
# Примените декоратор к замыканию.
# задачи:
# Замыкание для получения очередной строки из файла.
# Декоратор, который будет логировать вызовы функций.

import logging


def logger(func):  # Функция Декоратор
    def wrapper():  # Функция-обёртка, которая обёртывает функцию printer
        logging.basicConfig(filename='myapp.log',  # Название файла в котором содержится лог
                            format="%(asctime)s %(levelname)s %(message)s",  # Что конкретно выводим в логе (Время
                            # лога, уровень лога, сообщение)
                            datefmt="%H:%M:%S",  # Формат выводимой даты (Часы,минуты, секунды)
                            level=logging.INFO)  # Уровень лога (Информационный)
        logging.info(f'Func "{func.__name__}" is complited')  # Сообщение выводимое в логе (Функция "название функции"
        # выполнена)
        return func()  # Срабатывание функции считывания строки

    return wrapper  # Выход из обёртки


def reader(fname):  # Функция которая получит имя файла и передаст с помощью замыкания его во вложенную функцию printer
    file = open(fname + '.txt', "r")  # Создаем объект, получаем имя файла и его расширение и ткрываем для считывания

    @logger  # Декоратор
    def printer():  # Функция вывода строки из файла на экран
        try:  # Пробуем получить строку из файла
            line = file.readline()  # Считываем строку из файла и записываем её в line
        except ValueError:  # Если не получилось считать строку то выводим сообщение об ошибке
            return 'File Close'  # Сообщение об ошибке
        if not line:  # Если считали все строки из файла
            file.close()  # Закрываем файл
        return line.strip()  # Вывод текущей строки на экран

    return printer


name = input('Введите название файла: ')  # Запрос имени файла без расширения
r = reader(
    name)  # Создаем замыкание r, вызывая reader с параметром в котором хранится имя файла. Замыкание r ссылается на
# printer и хранит объект file.
kolvo = int(input('Сколько строк хотите считать из файла: '))
for i in range(kolvo):  # Цикл в котором будем вызываю функцию считывания строки и вывода её на экран
    print(
        r())  # Вызываем r  выводим результат. Замыкание r сохраняет значение file между вызовами, поэтому будет
    # считываться файл не сначала а со следующей строки
